<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login | Harold AI</title>
  <style>
    @import url("https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@500;600;700&family=Manrope:wght@500;600&display=swap");

    :root {
      --bg-a: #05101b;
      --bg-b: #0b2031;
      --bg-c: #123950;
      --line: rgba(173, 216, 240, 0.24);
      --text: #ecf6ff;
      --muted: #b8cad7;
      --card-a: rgba(9, 23, 36, 0.8);
      --card-b: rgba(14, 35, 52, 0.7);
      --btn-a: #2f7da6;
      --btn-b: #256c90;
      --btn-accent-a: #3f8f6f;
      --btn-accent-b: #2f7b5d;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      display: grid;
      place-items: center;
      color: var(--text);
      font-family: "Manrope", "Segoe UI", sans-serif;
      background:
        radial-gradient(circle at 16% 18%, rgba(80, 192, 243, 0.26), transparent 36%),
        radial-gradient(circle at 83% 84%, rgba(90, 228, 189, 0.22), transparent 34%),
        linear-gradient(145deg, var(--bg-a), var(--bg-b) 48%, var(--bg-c));
      overflow: hidden;
      position: relative;
      padding: 24px;
    }

    body::before,
    body::after {
      content: "";
      position: fixed;
      border-radius: 50%;
      filter: blur(22px);
      pointer-events: none;
      z-index: 0;
    }

    body::before {
      width: 340px;
      height: 340px;
      top: -130px;
      right: -90px;
      background: rgba(97, 196, 255, 0.24);
    }

    body::after {
      width: 300px;
      height: 300px;
      bottom: -120px;
      left: -80px;
      background: rgba(105, 211, 181, 0.2);
    }

    .login-shell {
      width: min(460px, 100%);
      position: relative;
      z-index: 1;
    }

    .login-card {
      border: 1px solid var(--line);
      border-radius: 22px;
      background: linear-gradient(170deg, var(--card-a), var(--card-b));
      backdrop-filter: blur(14px) saturate(120%);
      -webkit-backdrop-filter: blur(14px) saturate(120%);
      box-shadow: 0 28px 60px rgba(0, 0, 0, 0.38);
      padding: 28px 24px 24px;
    }

    .brand {
      font-family: "Space Grotesk", "Segoe UI", sans-serif;
      font-size: 1.55rem;
      font-weight: 700;
      margin: 0 0 6px;
      letter-spacing: 0.01em;
    }

    .subtitle {
      margin: 0 0 18px;
      color: var(--muted);
      font-size: 0.95rem;
    }

    .field {
      width: 100%;
      border: 1px solid rgba(168, 213, 237, 0.3);
      background: rgba(14, 31, 47, 0.65);
      color: var(--text);
      border-radius: 12px;
      padding: 12px 13px;
      font-size: 0.95rem;
      outline: none;
      margin-bottom: 10px;
      transition: border-color 0.15s ease, box-shadow 0.15s ease;
    }

    .field::placeholder {
      color: #94b3c8;
    }

    .field:focus {
      border-color: rgba(129, 202, 240, 0.78);
      box-shadow: 0 0 0 3px rgba(94, 170, 214, 0.18);
    }

    .actions {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 6px;
    }

    .btn {
      border: 1px solid rgba(166, 212, 236, 0.42);
      border-radius: 11px;
      color: #eff8ff;
      font-family: "Space Grotesk", "Segoe UI", sans-serif;
      font-size: 0.95rem;
      font-weight: 600;
      padding: 11px 12px;
      cursor: pointer;
      transition: transform 0.15s ease, filter 0.2s ease;
    }

    .btn:hover {
      transform: translateY(-1px);
      filter: brightness(1.06);
    }

    .btn-login {
      background: linear-gradient(145deg, var(--btn-a), var(--btn-b));
    }

    .btn-signup {
      background: linear-gradient(145deg, var(--btn-accent-a), var(--btn-accent-b));
    }

    .hint {
      margin: 14px 0 0;
      color: var(--muted);
      font-size: 0.82rem;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="login-shell">
    <div class="login-card">
      <h1 class="brand">Harold AI</h1>
      <p class="subtitle">Sign in to continue to your homework assistant.</p>

      <input id="email" class="field" type="email" placeholder="Email address" autocomplete="email">
      <input id="password" class="field" type="password" placeholder="Password" autocomplete="current-password">

      <div class="actions">
        <button type="button" class="btn btn-login" onclick="login()">Login</button>
        <button type="button" class="btn btn-signup" onclick="signup()">Sign Up</button>
      </div>

      <p class="hint">Your account is required to access chat.</p>
    </div>
  </div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyBVn9jn7bHOo39SD-7j9u9FltAVluiHAE4",
  authDomain: "haroldai-c2448.firebaseapp.com",
  projectId: "haroldai-c2448",
  storageBucket: "haroldai-c2448.firebasestorage.app",
  messagingSenderId: "596594757276",
  appId: "1:596594757276:web:62e3618ea88d0ce6552759"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

async function establishServerSession(user) {
  const idToken = await user.getIdToken();
  const res = await fetch("/auth/session", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      idToken
    })
  });

  if (!res.ok) {
    throw new Error("Could not create server session.");
  }
}

window.login = function() {
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;

  signInWithEmailAndPassword(auth, email, password)
    .then(async (result) => {
      await establishServerSession(result.user);
      window.location.href = "/";
    })
    .catch(error => alert(error.message));
};

window.signup = function() {
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;

  createUserWithEmailAndPassword(auth, email, password)
    .then(async (result) => {
      await establishServerSession(result.user);
      window.location.href = "/";
    })
    .catch(error => alert(error.message));
};

</script>
</body>
</html>
